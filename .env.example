# NOFX-Go 环境变量配置示例
# 复制此文件为 .env 并填入实际值

# ============================================================
# Redis 配置
# ============================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ============================================================
# 加密配置
# ============================================================
# 加密密钥（32字节或更长，用于加密API密钥）
# 生产环境必须设置此变量，不要使用默认值
# 生成方式：openssl rand -base64 32
# ENCRYPTION_KEY=your_encryption_key_here

# ============================================================
# Binance 交易所配置
# ============================================================
# 方式1：直接设置（不推荐，密钥会明文存储）
# BINANCE_API_KEY=your_binance_api_key_here
# BINANCE_SECRET_KEY=your_binance_secret_key_here

# 方式2：使用加密值（推荐）
# 使用工具加密：go run ./cmd/encrypt -key=BINANCE_API_KEY -value=your_api_key
# BINANCE_API_KEY=encrypted:xxxxx
# BINANCE_SECRET_KEY=encrypted:xxxxx
BINANCE_TESTNET=false
BINANCE_FAPI_BASE_URL=https://fapi.binance.com
BINANCE_HTTP_TIMEOUT_SEC=10.0
BINANCE_CONNECTOR_LIMIT=100
BINANCE_CONNECTOR_LIMIT_PER_HOST=30
BINANCE_RATE_LIMIT_MAX_SLEEP_SEC=1.0
BINANCE_MIN_ONLINE_DAYS=30

# ============================================================
# 运行模式
# ============================================================
# DRY_RUN=true 表示模拟模式，不会真实下单
DRY_RUN=true

# ============================================================
# AI 提供商配置
# ============================================================
# AI_PROVIDER: deepseek, openai, gemini
AI_PROVIDER=deepseek

# DeepSeek 配置
DEEPSEEK_ENABLED=false
# DEEPSEEK_API_KEY=your_deepseek_api_key_here
# 或使用加密值：go run ./cmd/encrypt -key=DEEPSEEK_API_KEY -value=your_api_key
# DEEPSEEK_API_KEY=encrypted:xxxxx
DEEPSEEK_BASE_URL=https://api.deepseek.com
DEEPSEEK_MODEL=deepseek-chat
DEEPSEEK_TEMPERATURE=0.3
DEEPSEEK_MAX_TOKENS=4000
DEEPSEEK_HISTORY_MAX_LEN=500

# OpenAI 配置
OPENAI_ENABLED=false
# OPENAI_API_KEY=your_openai_api_key_here
# 或使用加密值：go run ./cmd/encrypt -key=OPENAI_API_KEY -value=your_api_key
# OPENAI_API_KEY=encrypted:xxxxx
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o-mini
OPENAI_TEMPERATURE=0.3
OPENAI_MAX_TOKENS=4000

# Gemini 配置
GEMINI_ENABLED=false
# GEMINI_API_KEY=your_gemini_api_key_here
# 或使用加密值：go run ./cmd/encrypt -key=GEMINI_API_KEY -value=your_api_key
# GEMINI_API_KEY=encrypted:xxxxx
GEMINI_MODEL=gemini-pro
GEMINI_TEMPERATURE=0.3
GEMINI_MAX_TOKENS=4000

# AI 通用参数
AI_TEMPERATURE=0.3
AI_MAX_TOKENS=4000
AI_TRADER_SYSTEM_PROMPT=你是一名经验丰富的加密货币合约交易员，请根据提供的市场数据（包括链上数据、衍生品与资金数据、市场情绪指标、技术分析指标、全球宏观经济环境）自行分析交易并做出交易决策。

# AI 运行配置
AI_ANALYSIS_INTERVAL_SEC=180
AI_ANALYSIS_CONCURRENCY=3
AI_BATCH_SIZE=2
AI_FORCE_FULL_POOL_WHEN_NO_ACTION=false
AI_STATS_TTL_SEC=86400

# AI 预过滤配置
AI_PREFILTER_ENABLED=true
AI_PREFILTER_MIN_ABS_PCT_24H=0.8
AI_PREFILTER_MIN_ABS_OI_CHANGE=2.0
AI_PREFILTER_MIN_VOLUME_PEAK_RATIO=1.05
AI_PREFILTER_MIN_CONSECUTIVE_COUNT=2

# AI 历史记录
AI_REQUEST_HISTORY_MAX_LEN=500
AI_RESPONSE_HISTORY_MAX_LEN=500
AI_DECISION_HISTORY_MAX_LEN=500
SIGNAL_HISTORY_MAX_LEN=500
TRADE_HISTORY_MAX_LEN=500

# ============================================================
# 交易策略配置
# ============================================================
STRATEGY_FILE=strategies/顺势狙击手.txt
RULE_STRATEGY=shunshi_sniper
DEFAULT_TRADING_MODE=

# ============================================================
# 市场扫描配置
# ============================================================
SCAN_INTERVAL=180
PRICE_CHANGE_THRESHOLD=3.0
SCAN_CONCURRENCY=10
MARKET_SNAPSHOT_TTL_SEC=600
MARKET_SNAPSHOT_MAX_AGE_SEC=300
SIGNAL_TTL_SEC=3600
MAX_TRADE_QUEUE_SIZE=100
SYMBOL_POOL_TTL_SEC=1800
OI_LAST_TTL_SEC=3600

# ============================================================
# 执行引擎风控参数
# ============================================================
MAX_NOTIONAL_PER_TRADE=50.0
MAX_LEVERAGE=10.0
MAX_CONCURRENT_POSITIONS=5
SYMBOL_COOLDOWN_SEC=120
ORDER_DEDUPE_WINDOW=5
BREAKOUT_TIMEOUT_SEC=120
ORDER_AUDIT_MAX_LEN=2000
ORDER_AUDIT_EVENT_MAX_CHARS=2000

# ============================================================
# 止损止盈守护配置
# ============================================================
SLTP_GUARD_INTERVAL_SEC=10.0
GUARD_STATS_TTL_SEC=1728000
PROTECTION_TTL_SEC=86400
TP1_PARTIAL_RATIO=0.5
TP_MATCH_TOLERANCE_PCT=0.5
TAKE_PROFIT_ORDER_TYPE=limit
MAX_TP_DEVIATION_PCT=25.0

# ============================================================
# 交易所缓存配置
# ============================================================
EXCHANGE_CACHE_TTL_SEC=10.0

# ============================================================
# 策略阈值配置
# ============================================================
RSI_OVERBOUGHT=78.0
RSI_OVERSOLD=22.0
VOLUME_SHRINK_RATIO=0.85
BB_SQUEEZE_BANDWIDTH=0.01

# ============================================================
# 技术指标参数
# ============================================================
IND_EMA_PERIOD_20=20
IND_EMA_PERIOD_50=50
IND_EMA_PERIOD_200=200
IND_RSI_PERIOD=14
IND_BB_PERIOD=20
IND_BB_STD_DEV=2.0
IND_CVD_PERIOD=50

# ============================================================
# 规则/AI 共用策略阈值
# ============================================================
STRAT_CONSECUTIVE_MIN=2
STRAT_EMA_DIVERGENCE_MIN=0.0008
STRAT_EMA200_WALL_PCT=0.0015
STRAT_EMA200_HOLD_WARN_PCT=0.002
STRAT_ZONE_TOL_PCT=0.003
STRAT_BREAKOUT_VOL_RATIO=1.05
STRAT_SQUEEZE_REJECT_VOL_RATIO=0.6
STRAT_OI_DROP_REJECT_PCT=8.0
STRAT_MIN_PROFIT_PCT=0.0020
STRAT_MIN_RR=1.1
STRAT_SL_EMA50_BUFFER_PCT=0.0005
STRAT_BREAKEVEN_PCT=0.0015
STRAT_TP2_R_MULT=3.0
STRAT_TP2_FALLBACK_PCT=0.01
STRAT_DEFAULT_NOTIONAL_USDT=20.0

# ============================================================
# WebSocket 配置
# ============================================================
WS_TOKEN_TTL_SEC=60

# ============================================================
# 告警配置
# ============================================================
ALERT_ENABLED=false
ALERT_WEBHOOK_URL=
ALERT_DEDUPE_TTL_SEC=300
ALERT_MIN_INTERVAL_SEC=10

# ============================================================
# 性能监控配置
# ============================================================
METRICS_ENABLED=true
METRICS_SYMBOL_SOURCE=scanner
METRICS_MAX_SYMBOLS=30
METRICS_SYMBOLS=
METRICS_TIMEFRAMES=5m,15m,1h,4h,1d
METRICS_GLOBAL_REFRESH_SEC=900
METRICS_GLOBAL_TTL_SEC=86400
METRICS_SYMBOL_TTL_SEC=2592000
METRICS_HTTP_TIMEOUT_SEC=10.0
METRICS_HTTP_CONNECTOR_LIMIT=50
METRICS_HTTP_CONNECTOR_LIMIT_PER_HOST=20
METRICS_CONCURRENCY=3
METRICS_OHLCV_LIMIT=210
METRICS_FORCE_ORDERS_LIMIT=50

# ============================================================
# 链上数据配置（可选，如不使用可删除）
# ============================================================
COINGECKO_BASE_URL=https://api.coingecko.com/api/v3
GLASSNODE_API_KEY=
WHALE_ALERT_API_KEY=
WHALE_ALERT_CURRENCIES=btc,eth
WHALE_ALERT_MIN_VALUE_USD=10000000.0
WHALE_ALERT_LOOKBACK_SEC=3600
WHALE_ALERT_LIMIT=20

# ============================================================
# OI异动池配置（可选，如不使用可删除）
# ============================================================
OI_ENABLED=false
OI_THRESHOLD=5.0
OI_INTERVAL_MINUTES=5
OI_EXPIRE_MINUTES=30
OI_CONCURRENCY=20
OI_USE_WHITELIST=false
OI_WHITELIST=

# ============================================================
# Web 服务配置
# ============================================================
WEB_PORT=8000
WEB_BASIC_AUTH_USER=
WEB_BASIC_AUTH_PASS=
WEB_STATIC_DIR=web/static
WEB_TEMPLATES_DIR=web/templates
WEB_DASHBOARD_TEMPLATE=web/templates/dashboard.html
WEB_STATUS_CACHE_TTL_SEC=15.0
WEB_CHARTJS_SRC=https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js
WEB_CHARTJS_INTEGRITY=
WEB_CHARTJS_CROSSORIGIN=anonymous
# WebSocket Origin白名单（逗号分隔，例如：http://localhost:3000,https://example.com）
WEB_ALLOWED_ORIGINS=

# ============================================================
# 运行时配置
# ============================================================
RUNTIME_CONFIG_CACHE_TTL_SEC=3.0
RUNTIME_CONFIG_WRITE_ENABLED=true
RUNTIME_CONFIG_AUDIT_MAX_LEN=2000

# ============================================================
# 日志配置
# ============================================================
# LOG_LEVEL: DEBUG, INFO, WARN, ERROR
LOG_LEVEL=INFO
